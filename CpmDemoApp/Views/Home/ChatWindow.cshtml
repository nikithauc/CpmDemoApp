<div class="chat-header">
    Chat Conversation
</div>
<div class="chat-messages" id="scrollable-div">
    @if (LiveChat.MessagesListStatic != null && LiveChat.MessagesListStatic.Any())
    {
        @foreach (var message in LiveChat.MessagesListStatic)
        {
            <div class="@(!message.IsFromReceiver? "message user": "message assistant")">
                <div class="text">@message.Text</div>
            </div>
        }
    }     
</div>

<script>
    function loadPartialView() {
        $.ajax({
            url: "@Url.Action("MessagesList", "Home")",
            type: 'POST',
            dataType: 'html',
            cache: false,
            success: function (html) {
                $("#partialContainer").html(html);
            }
        });
    }
    function RefreshPartial() {
        //this will wait 1 seconds and then fire the load partial function
        var scrollableDiv = document.getElementById('scrollable-div');
        var scrollPosition = scrollableDiv.scrollTop;
        console.log('Scroll position: ' + scrollPosition);

        // Restore scroll position
        scrollableDiv.scrollTop = scrollPosition;
        setTimeout(function () {
            loadPartialView();
            //recall this function so that it will continue to loop
            RefreshPartial();
        }, 1000);
    }
    //initialize the loop
    RefreshPartial();
</script>
  
